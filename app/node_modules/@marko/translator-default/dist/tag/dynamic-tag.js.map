{"version":3,"sources":["../../src/tag/dynamic-tag.js"],"names":["path","node","hub","file","tagProperties","key","arguments","args","foundAttrs","renderBodyProp","attrsLen","t","isNullLiteral","preserveAttrs","push","objectProperty","identifier","arrayExpression","map","name","stringLiteral","isObjectExpression","renderBodyIndex","properties","findIndex","prop","value","length","splice","dynamicTagRenderCall","expressionStatement","callExpression","arrowFunctionExpression","nullLiteral","objectExpression","_componentDefIdentifier","replaceWith"],"mappings":"uJAAA;AACA;AACA;AACA;;AAEe,kBAAUA,IAAV,EAAgB;AAC7B,QAAM;AACJC,IAAAA,IADI;AAEJC,IAAAA,GAAG,EAAE,EAAEC,IAAF,EAFD;AAGFH,EAAAA,IAHJ;AAIA,QAAMI,aAAa,GAAG,EAAtB;AACA,QAAM,EAAEC,GAAF,EAAOC,SAAS,EAAEC,IAAlB,KAA2BN,IAAjC;AACA,QAAMO,UAAU,GAAG,oBAASR,IAAT,EAAe,IAAf,CAAnB;AACA,MAAIS,cAAJ;AACA,MAAIC,QAAQ,GAAGC,gBAAEC,aAAF,CAAgBJ,UAAhB,IAA8B,CAA9B,GAAkC,CAAjD;;AAEA,MAAIP,IAAI,CAACY,aAAT,EAAwB;AACtBT,IAAAA,aAAa,CAACU,IAAd;AACEH,oBAAEI,cAAF;AACEJ,oBAAEK,UAAF,CAAa,IAAb,CADF;AAEEL,oBAAEM,eAAF,CAAkBhB,IAAI,CAACY,aAAL,CAAmBK,GAAnB,CAAuBC,IAAI,IAAIR,gBAAES,aAAF,CAAgBD,IAAhB,CAA/B,CAAlB,CAFF,CADF;;;AAMD;;AAED,MAAIR,gBAAEU,kBAAF,CAAqBb,UAArB,CAAJ,EAAsC;AACpC,UAAMc,eAAe,GAAGd,UAAU,CAACe,UAAX,CAAsBC,SAAtB;AACtBC,IAAAA,IAAI,IAAIA,IAAI,CAACpB,GAAL,IAAYoB,IAAI,CAACpB,GAAL,CAASqB,KAAT,KAAmB,YADjB,CAAxB;;;AAIAhB,IAAAA,QAAQ,GAAGF,UAAU,CAACe,UAAX,CAAsBI,MAAjC;;AAEA,QAAIL,eAAe,GAAG,CAAC,CAAvB,EAA0B;AACxBb,MAAAA,cAAc,GAAGD,UAAU,CAACe,UAAX,CAAsBD,eAAtB,CAAjB;AACAd,MAAAA,UAAU,CAACe,UAAX,CAAsBK,MAAtB,CAA6BN,eAA7B,EAA8C,CAA9C;AACAZ,MAAAA,QAAQ;AACT;AACF;;AAED,QAAMmB,oBAAoB,GAAGlB,gBAAEmB,mBAAF;AAC3BnB,kBAAEoB,cAAF;AACE;AACE5B,EAAAA,IADF;AAEG,yCAFH;AAGE,qBAHF,CADF;;AAME;AACEQ,kBAAEK,UAAF,CAAa,KAAb,CADF;AAEEf,EAAAA,IAAI,CAACkB,IAFP;AAGET,EAAAA,QAAQ,GAAGC,gBAAEqB,uBAAF,CAA0B,EAA1B,EAA8BxB,UAA9B,CAAH,GAA+CG,gBAAEsB,WAAF,EAHzD;AAIExB,EAAAA,cAAc,GAAGA,cAAc,CAACiB,KAAlB,GAA0Bf,gBAAEsB,WAAF,EAJ1C;AAKE1B,EAAAA,IAAI,IAAIA,IAAI,CAACoB,MAAb,GAAsBhB,gBAAEM,eAAF,CAAkBV,IAAlB,CAAtB,GAAgDI,gBAAEsB,WAAF,EALlD;AAME7B,EAAAA,aAAa,CAACuB,MAAd;AACIhB,kBAAEuB,gBAAF,CAAmB9B,aAAnB,CADJ;AAEIO,kBAAEsB,WAAF,EARN;AASE9B,EAAAA,IAAI,CAACgC,uBATP;AAUE9B,EAAAA,GAVF;AAWE,KAAG,kCAAuBL,IAAvB,CAXL,CANF,CAD2B,CAA7B;;;;;AAuBAA,EAAAA,IAAI,CAACoC,WAAL,CAAiB,mCAAqBP,oBAArB,EAA2C5B,IAA3C,CAAjB;AACD","sourcesContent":["import { types as t } from \"@marko/compiler\";\nimport { importDefault } from \"@marko/babel-utils\";\nimport { getAttrs, buildEventHandlerArray } from \"./util\";\nimport withPreviousLocation from \"../util/with-previous-location\";\n\nexport default function (path) {\n  const {\n    node,\n    hub: { file }\n  } = path;\n  const tagProperties = [];\n  const { key, arguments: args } = node;\n  const foundAttrs = getAttrs(path, true);\n  let renderBodyProp;\n  let attrsLen = t.isNullLiteral(foundAttrs) ? 0 : 1;\n\n  if (node.preserveAttrs) {\n    tagProperties.push(\n      t.objectProperty(\n        t.identifier(\"pa\"),\n        t.arrayExpression(node.preserveAttrs.map(name => t.stringLiteral(name)))\n      )\n    );\n  }\n\n  if (t.isObjectExpression(foundAttrs)) {\n    const renderBodyIndex = foundAttrs.properties.findIndex(\n      prop => prop.key && prop.key.value === \"renderBody\"\n    );\n\n    attrsLen = foundAttrs.properties.length;\n\n    if (renderBodyIndex > -1) {\n      renderBodyProp = foundAttrs.properties[renderBodyIndex];\n      foundAttrs.properties.splice(renderBodyIndex, 1);\n      attrsLen--;\n    }\n  }\n\n  const dynamicTagRenderCall = t.expressionStatement(\n    t.callExpression(\n      importDefault(\n        file,\n        `marko/src/runtime/helpers/dynamic-tag`,\n        \"marko_dynamic_tag\"\n      ),\n      [\n        t.identifier(\"out\"),\n        node.name,\n        attrsLen ? t.arrowFunctionExpression([], foundAttrs) : t.nullLiteral(),\n        renderBodyProp ? renderBodyProp.value : t.nullLiteral(),\n        args && args.length ? t.arrayExpression(args) : t.nullLiteral(),\n        tagProperties.length\n          ? t.objectExpression(tagProperties)\n          : t.nullLiteral(),\n        file._componentDefIdentifier,\n        key,\n        ...buildEventHandlerArray(path)\n      ]\n    )\n  );\n\n  path.replaceWith(withPreviousLocation(dynamicTagRenderCall, node));\n}\n"],"file":"dynamic-tag.js"}