{"version":3,"sources":["../../../src/taglib/core/parse-module-code.js"],"names":["startOffset","length","path","hub","file","node","rawValue","dirname","nodePath","opts","sourceFileName","relativeRequire","entry","markoModules","require","fn","eval","slice","source","markoOpts","metadata","marko","moduleCode"],"mappings":"uJAAA;AACA;AACA;;AAEA,MAAMA,WAAW,GAAG,cAAcC,MAAlC;;AAEe,kBAAUC,IAAV,EAAgB;AAC7B,QAAM;AACJC,IAAAA,GAAG,EAAE,EAAEC,IAAF,EADD;AAEJC,IAAAA,IAAI,EAAE,EAAEC,QAAF,EAFF;AAGFJ,EAAAA,IAHJ;AAIA,QAAMK,OAAO,GAAGC,cAASD,OAAT,CAAiBH,IAAI,CAACK,IAAL,CAAUC,cAA3B,CAAhB;AACA,QAAMC,eAAe,GAAG,CAAAC,KAAK;AAC3BC,mBAAaC,OAAb,CAAqB,0BAAYP,OAAZ,EAAqBK,KAArB,CAArB,CADF;AAEA,QAAMG,EAAE,GAAGC,IAAI,CAACV,QAAQ,CAACW,KAAT,CAAejB,WAAf,CAAD,CAAf;AACA,QAAMkB,MAAM,GAAGH,EAAE,CAACJ,eAAD,EAAkBP,IAAI,CAACe,SAAvB,CAAjB;AACAf,EAAAA,IAAI,CAACgB,QAAL,CAAcC,KAAd,CAAoBC,UAApB,GAAiCJ,MAAjC;AACD","sourcesContent":["import nodePath from \"path\";\nimport resolveFrom from \"resolve-from\";\nimport markoModules from \"@marko/compiler/modules\";\n\nconst startOffset = \"module-code\".length;\n\nexport default function (path) {\n  const {\n    hub: { file },\n    node: { rawValue }\n  } = path;\n  const dirname = nodePath.dirname(file.opts.sourceFileName);\n  const relativeRequire = entry =>\n    markoModules.require(resolveFrom(dirname, entry));\n  const fn = eval(rawValue.slice(startOffset));\n  const source = fn(relativeRequire, file.markoOpts);\n  file.metadata.marko.moduleCode = source;\n}\n"],"file":"parse-module-code.js"}